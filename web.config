<?xml version="1.0" encoding="UTF-8"?>
<!-- ================================================ -->
<!-- COMPREHENSIVE WEBSITE SECURITY CONFIGURATION -->
<!-- For IIS/Windows Servers -->
<!-- ================================================ -->
<configuration>
    <system.webServer>
        
        <!-- ================================================ -->
        <!-- URL REWRITE RULES -->
        <!-- ================================================ -->
        <rewrite>
            <rules>
                <!-- Redirect space-slug URLs to hyphen-slug equivalents -->
                <rule name="SpaceSlug_ai seo" stopProcessing="true">
                    <match url="^ai seo/?$" />
                    <action type="Redirect" url="/ai-seo" redirectType="Permanent" />
                </rule>
                <rule name="SpaceSlug_best seo company in sri lanka" stopProcessing="true">
                    <match url="^best seo company in sri lanka/?$" />
                    <action type="Redirect" url="/best-seo-company-sri-lanka" redirectType="Permanent" />
                </rule>
                <rule name="SpaceSlug_seo expert in srilanka" stopProcessing="true">
                    <match url="^seo expert in srilanka/?$" />
                    <action type="Redirect" url="/seo-expert-sri-lanka" redirectType="Permanent" />
                </rule>
                <rule name="SpaceSlug_seo specialist sri lanka" stopProcessing="true">
                    <match url="^seo specialist sri lanka/?$" />
                    <action type="Redirect" url="/seo-specialist-sri-lanka" redirectType="Permanent" />
                </rule>
                <rule name="SpaceSlug_seo sri lanka" stopProcessing="true">
                    <match url="^seo sri lanka/?$" />
                    <action type="Redirect" url="/seo-sri-lanka" redirectType="Permanent" />
                </rule>
                <!-- Redirect .html URLs to extensionless versions -->
                <rule name="RemoveHtmlExtension" stopProcessing="true">
                    <match url="^(.*)\.html$" />
                    <conditions>
                        <add input="{REQUEST_FILENAME}" matchType="IsFile" />
                    </conditions>
                    <action type="Redirect" url="{R:1}" redirectType="Permanent" />
                </rule>
                
                <!-- Serve .html files for extensionless URLs -->
                <rule name="RewriteHtmlExtension" stopProcessing="true">
                    <match url="^(.*)$" />
                    <conditions>
                        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
                        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
                        <add input="{REQUEST_FILENAME}.html" matchType="IsFile" />
                    </conditions>
                    <action type="Rewrite" url="{R:1}.html" />
                </rule>
                
                <!-- Force HTTPS -->
                <rule name="ForceHTTPS" stopProcessing="true">
                    <match url="(.*)" />
                    <conditions>
                        <add input="{HTTPS}" pattern="off" ignoreCase="true" />
                    </conditions>
                    <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" redirectType="Permanent" />
                </rule>
                
                <!-- Block SQL Injection -->
                <rule name="BlockSQLInjection" stopProcessing="true">
                    <match url=".*" />
                    <conditions>
                        <add input="{QUERY_STRING}" pattern="(union|select|insert|update|delete|drop|create|alter|cast|execute|declare)" ignoreCase="true" />
                    </conditions>
                    <action type="CustomResponse" statusCode="403" statusReason="Forbidden" statusDescription="SQL Injection Attempt Detected" />
                </rule>
                
                <!-- Block XSS Attacks -->
                <rule name="BlockXSS" stopProcessing="true">
                    <match url=".*" />
                    <conditions>
                        <add input="{QUERY_STRING}" pattern="(&lt;|%3C).*script.*(&gt;|%3E)" ignoreCase="true" />
                    </conditions>
                    <action type="CustomResponse" statusCode="403" statusReason="Forbidden" statusDescription="XSS Attempt Detected" />
                </rule>
                
                <!-- Block Directory Traversal -->
                <rule name="BlockDirectoryTraversal" stopProcessing="true">
                    <match url=".*" />
                    <conditions>
                        <add input="{QUERY_STRING}" pattern="(\.\./|\.\.\\|etc/passwd|boot\.ini)" ignoreCase="true" />
                    </conditions>
                    <action type="CustomResponse" statusCode="403" statusReason="Forbidden" statusDescription="Directory Traversal Attempt Detected" />
                </rule>
            </rules>
        </rewrite>
        
        <!-- ================================================ -->
        <!-- SECURITY HEADERS -->
        <!-- ================================================ -->
        <httpProtocol>
            <customHeaders>
                <!-- Prevent Clickjacking -->
                <add name="X-Frame-Options" value="SAMEORIGIN" />
                
                <!-- Enable XSS Protection -->
                <add name="X-XSS-Protection" value="1; mode=block" />
                
                <!-- Prevent MIME Type Sniffing -->
                <add name="X-Content-Type-Options" value="nosniff" />
                
                <!-- Referrer Policy -->
                <add name="Referrer-Policy" value="strict-origin-when-cross-origin" />
                
                <!-- Content Security Policy -->
                <add name="Content-Security-Policy" value="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.google-analytics.com https://www.googletagmanager.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com data:; img-src 'self' data: https: http:; connect-src 'self'; frame-ancestors 'self'; base-uri 'self'; form-action 'self';" />
                
                <!-- Permissions Policy -->
                <add name="Permissions-Policy" value="geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=()" />
                
                <!-- HTTP Strict Transport Security (HSTS) -->
                <add name="Strict-Transport-Security" value="max-age=31536000; includeSubDomains; preload" />
                
                <!-- Remove Server Header -->
                <remove name="X-Powered-By" />
                <remove name="Server" />
            </customHeaders>
        </httpProtocol>
        
        <!-- ================================================ -->
        <!-- HIDE SERVER INFORMATION -->
        <!-- ================================================ -->
        <security>
            <requestFiltering removeServerHeader="true">
                <!-- Maximum request size: 5MB -->
                <requestLimits maxAllowedContentLength="5242880" maxQueryString="2048" maxUrl="4096" />
                
                <!-- Block dangerous file extensions -->
                <fileExtensions>
                    <add fileExtension=".asa" allowed="false" />
                    <add fileExtension=".asax" allowed="false" />
                    <add fileExtension=".ascx" allowed="false" />
                    <add fileExtension=".bak" allowed="false" />
                    <add fileExtension=".backup" allowed="false" />
                    <add fileExtension=".config" allowed="false" />
                    <add fileExtension=".old" allowed="false" />
                    <add fileExtension=".sql" allowed="false" />
                    <add fileExtension=".log" allowed="false" />
                    <add fileExtension=".env" allowed="false" />
                </fileExtensions>
                
                <!-- Block hidden segments -->
                <hiddenSegments>
                    <add segment="bin" />
                    <add segment="App_code" />
                    <add segment="App_Data" />
                    <add segment="App_GlobalResources" />
                    <add segment="App_LocalResources" />
                    <add segment="App_WebReferences" />
                    <add segment=".git" />
                    <add segment=".svn" />
                    <add segment=".htaccess" />
                    <add segment="web.config" />
                </hiddenSegments>
                
                <!-- Block dangerous verbs -->
                <verbs>
                    <add verb="TRACE" allowed="false" />
                    <add verb="TRACK" allowed="false" />
                    <add verb="OPTIONS" allowed="false" />
                </verbs>
            </requestFiltering>
        </security>
        
        <!-- ================================================ -->
        <!-- DISABLE DIRECTORY BROWSING -->
        <!-- ================================================ -->
        <directoryBrowse enabled="false" />
        
        <!-- ================================================ -->
        <!-- STATIC CONTENT CACHING -->
        <!-- ================================================ -->
        <staticContent>
            <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="365.00:00:00" />
            
            <!-- Add MIME types for modern formats -->
            <remove fileExtension=".woff" />
            <mimeMap fileExtension=".woff" mimeType="application/font-woff" />
            <remove fileExtension=".woff2" />
            <mimeMap fileExtension=".woff2" mimeType="application/font-woff2" />
            <remove fileExtension=".webp" />
            <mimeMap fileExtension=".webp" mimeType="image/webp" />
            <remove fileExtension=".svg" />
            <mimeMap fileExtension=".svg" mimeType="image/svg+xml" />
        </staticContent>
        
        <!-- ================================================ -->
        <!-- COMPRESSION FOR PERFORMANCE -->
        <!-- ================================================ -->
        <urlCompression doStaticCompression="true" doDynamicCompression="true" />
        
        <httpCompression directory="%SystemDrive%\inetpub\temp\IIS Temporary Compressed Files">
            <scheme name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll" />
            <dynamicTypes>
                <add mimeType="text/*" enabled="true" />
                <add mimeType="message/*" enabled="true" />
                <add mimeType="application/javascript" enabled="true" />
                <add mimeType="application/json" enabled="true" />
                <add mimeType="application/xml" enabled="true" />
                <add mimeType="*/*" enabled="false" />
            </dynamicTypes>
            <staticTypes>
                <add mimeType="text/*" enabled="true" />
                <add mimeType="message/*" enabled="true" />
                <add mimeType="application/javascript" enabled="true" />
                <add mimeType="application/json" enabled="true" />
                <add mimeType="application/xml" enabled="true" />
                <add mimeType="*/*" enabled="false" />
            </staticTypes>
        </httpCompression>
        
        <!-- ================================================ -->
        <!-- ERROR PAGES -->
        <!-- ================================================ -->
        <httpErrors errorMode="Custom" existingResponse="Replace">
            <remove statusCode="403" />
            <error statusCode="403" path="/403.html" responseMode="File" />
            <remove statusCode="404" />
            <error statusCode="404" path="/404.html" responseMode="File" />
            <remove statusCode="500" />
            <error statusCode="500" path="/500.html" responseMode="File" />
        </httpErrors>
        
    </system.webServer>
    
    <!-- ================================================ -->
    <!-- ADDITIONAL SECURITY SETTINGS -->
    <!-- ================================================ -->
    <system.web>
        <!-- Disable debug compilation -->
        <compilation debug="false" />
        
        <!-- Session security -->
        <sessionState cookieless="UseCookies" cookieSameSite="Strict" />
        
        <!-- Forms authentication (if used) -->
        <authentication mode="Forms">
            <forms protection="All" requireSSL="true" slidingExpiration="true" timeout="30" />
        </authentication>
        
        <!-- Custom errors -->
        <customErrors mode="On" defaultRedirect="/500.html">
            <error statusCode="403" redirect="/403.html" />
            <error statusCode="404" redirect="/404.html" />
        </customErrors>
        
        <!-- Trace disabled for security -->
        <trace enabled="false" />
        
        <!-- Page output caching -->
        <pages enableViewStateMac="true" validateRequest="true" />
    </system.web>
</configuration>
